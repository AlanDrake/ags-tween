// room 102 (GUI Control Tests) script file

#ifdef SCRIPT_API_v350
int _lstSelectedBackColor, _lstSelectedTextColor, _lstTextColor;

int UpdateRedInColor(int color, int red) {
  return Game.GetColorFromRGB(red, TweenGame.GetGFromColor(color), TweenGame.GetBFromColor(color));
}

int UpdateGreenInColor(int color, int green) {
  return Game.GetColorFromRGB(TweenGame.GetRFromColor(color), green, TweenGame.GetBFromColor(color));
}

int UpdateBlueInColor(int color, int blue) {
  return Game.GetColorFromRGB(TweenGame.GetRFromColor(color), TweenGame.GetGFromColor(color), blue);
}

int UpdateRedInSelectedBackColor(int red) { return UpdateRedInColor(_lstSelectedBackColor, red); }
int UpdateGreenInSelectedBackColor(int green) { return UpdateGreenInColor(_lstSelectedBackColor, green); }
int UpdateBlueInSelectedBackColor(int blue) { return UpdateBlueInColor(_lstSelectedBackColor, blue); }
#endif

function SaveGUIControls() {
  #ifdef SCRIPT_API_v350
  _lstSelectedBackColor = lstTest.SelectedBackColor;
  _lstSelectedTextColor = lstTest.SelectedTextColor;
  _lstTextColor = lstTest.TextColor;
  #endif
}

function RestoreGUIControls() {
  #ifdef SCRIPT_API_v350
  lstTest.SelectedBackColor = _lstSelectedBackColor;
  lstTest.SelectedTextColor = _lstSelectedTextColor;
  lstTest.TextColor = _lstTextColor;
  #endif
}

function testListBoxSelectedBackColor() {
  #ifdef SCRIPT_API_v350
  SaveGUIControls();
  Test("ListBox.SelectedBackColor");

  int expectedColor = UpdateRedInSelectedBackColor(128);
  lstTest.TweenSelectedBackColorRed(0.5, 128, eEaseInBackTween);
  ExpectIntToBe("Red", lstTest.SelectedBackColor, expectedColor);

  RestoreGUIControls();

  expectedColor = UpdateGreenInSelectedBackColor(128);
  lstTest.TweenSelectedBackColorGreen(0.5, 128, eEaseInBackTween);
  ExpectIntToBe("Green", lstTest.SelectedBackColor, expectedColor);

  RestoreGUIControls();

  expectedColor = UpdateBlueInSelectedBackColor(128);
  lstTest.TweenSelectedBackColorBlue(0.5, 128, eEaseInBackTween);
  ExpectIntToBe("Blue", lstTest.SelectedBackColor, expectedColor);

  RestoreGUIControls();

  int toColor = Game.GetColorFromRGB(64, 128, 255);

  lstTest.TweenSelectedBackColor(0.5, toColor, eEaseInBackTween);
  ExpectIntToBe("Color", lstTest.SelectedBackColor, toColor);

  RestoreGUIControls();

  lstTest.TweenSelectedBackColorRGB(0.5, 64, 128, 255, eEaseInBackTween);
  ExpectIntToBe("ColorRGB", lstTest.SelectedBackColor, toColor);

  RestoreGUIControls();

  expectedColor = UpdateRedInSelectedBackColor(128);
  int lerpColor = Game.GetColorFromRGB(
    TweenMaths.ClampInt(0, TweenMaths.Lerp(IntToFloat(TweenGame.GetRFromColor(lstTest.SelectedBackColor)), 128.0, 1.0), 255),
    TweenGame.GetGFromColor(lstTest.SelectedBackColor),
    TweenGame.GetBFromColor(lstTest.SelectedBackColor)
  );
  lstTest.TweenSelectedBackColorRed(0.5, 128, eEaseLinearTween, eNoBlockTween);
  lstTest.StopTweenSelectedBackColorRed(eFinishTween);
  ExpectIntToBe("R Finish", lstTest.SelectedBackColor, expectedColor);

  RestoreGUIControls();

  expectedColor = UpdateGreenInSelectedBackColor(128);
  lstTest.TweenSelectedBackColorGreen(0.5, 128, eEaseLinearTween, eNoBlockTween);
  lstTest.StopTweenSelectedBackColorGreen(eFinishTween);
  ExpectIntToBe("G Finish", lstTest.SelectedBackColor, expectedColor);

  RestoreGUIControls();

  expectedColor = UpdateBlueInSelectedBackColor(128);
  lstTest.TweenSelectedBackColorBlue(0.5, 128, eEaseLinearTween, eNoBlockTween);
  lstTest.StopTweenSelectedBackColorBlue(eFinishTween);
  ExpectIntToBe("B Finish", lstTest.SelectedBackColor, expectedColor);

  RestoreGUIControls();

  lstTest.TweenSelectedBackColor(0.5, toColor, eEaseLinearTween, eNoBlockTween);
  lstTest.StopTweenSelectedBackColor(eFinishTween);
  ExpectIntToBe("Color Finish", lstTest.SelectedBackColor, toColor);

  RestoreGUIControls();

  lstTest.TweenSelectedBackColorRGB(0.5, 64, 128, 255, eEaseLinearTween, eNoBlockTween);
  lstTest.StopTweenSelectedBackColor(eFinishTween);
  ExpectIntToBe("ColorRGB Finish", lstTest.SelectedBackColor, toColor);

  RestoreGUIControls();
  #endif
}

function room_AfterFadeIn()
{
  testListBoxSelectedBackColor();
  player.ChangeRoom(99);
}

function room_Load()
{
  gControlsTest.Visible = true;
}

function room_FirstLoad()
{
  SaveGUIControls();
  lstTest.FillDirList("*");
  lstTest.SelectedIndex = lstTest.ItemCount - 1;
}

function room_Leave()
{
  RestoreGUIControls();
  gControlsTest.Visible = false;
}

function room_RepExec()
{

}
